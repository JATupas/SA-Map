{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHADE Project PH</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/stylesheet-ECC.css' %}">
</head>

<body>
    <header>
        <div class="header-container">
            <div class="logo-container">
                <img src="{% static 'images/SHADE LOGO.png' %}" alt="PHIVOLCS Logo" class="logo">
                <div class="text-container">
                    <h2>Philippine Institute of Volcanology and Seismology</h2>
                    <h1>SHADE PH</h1>
                </div>
            </div>
            <nav>
                <a href="{% url 'shade_redesign' %}" class="nav-link">Home</a>
                <a href="#About-section" class="nav-link">About</a>
                <span class="separator">|</span>
                <b href="#" class="nav-link">Register</b>
                <a href="#" class="nav-button">Log In</a>
            </nav>
        </div>
    </header>
    
    <main>
        <section class="Home" id="Home">
            <div class="container1">
                <div class="Title">
                    <h1>SHADE Project PH</h1>
                    <p>Seismic Hazard Assessment for Design Earthquake of the Philippines</p>
                </div>
                
                <div class="container2">
                    <div class="about-card" id="about-card">
                        <!-- <img src="{% static 'images/NO IMAGE DARK.svg' %}" alt="Img 1" class="img1"> -->
                        <h2 id="about-title">About</h2>
                        <p id="about-description">
                            Lorem ipsum dolor sit amet consectetur. Vestibulum urna pulvinar aliquam volutpat. Sed libero egestas felis faucibus id nunc. Integer dui amet sagittis sed et consequat. Non tempus tempor aliquet lacus potenti aliquam.
                        </p>
                    </div>

                    <div class="form">
                        <div class="form-card">
                            <div class="form-header">
                                <img src="{% static 'images/ECC Header.svg' %}" class="card-icon">
                                <h2>Earthquake Catalog Cleaner</h2>
                            </div>                                   
                            
                            <div class="form-content">
                                <form id="catalog-cleaning-form">
                                    <div class="ECC-input-group">
                                        <label for="input-file-path">Input Folder or File(s)</label>
                                        <input type="text" id="input-file-path" name="input_file_path" placeholder="C:/Users/SHADE/Raw-Data-Folder/">
                                    </div>
                                    <div class="ECC-output-group">
                                        <label for="output-file-path">Output Folder</label>
                                        <input type="text" id="output-file-path" name="output_file_path" placeholder="C:/Users/SHADE/Processed-Data-Folder/">
                                    </div>
                                </form>
                            </div>

                            <div class="button-group">
                                <button type="button" id="clean_button">Clean and Process Data</button>
                            </div>
                            
                            <div id="loading-popup" style="display: none;">
                                <div class="popup-content">
                                    <p>Processing data, please wait...</p>
                                    <div class="loading-spinner"></div>
                                    <button id="done_button" style="display: none;">Done</button>
                                </div>
                            </div>
                            
                            <style>
                                .loading-spinner {
                                    border: 16px solid #f3f3f3;
                                    border-radius: 50%;
                                    border-top: 16px solid blue;
                                    width: 80px;
                                    height: 80px;
                                    animation: spin 2s linear infinite;
                                }
                            
                                @keyframes spin {
                                    0% { transform: rotate(0deg); }
                                    100% { transform: rotate(360deg); }
                                }
                            
                                #loading-popup {
                                    position: fixed;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                    background-color: rgba(0, 0, 0, 0.5);
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                }
                            
                                .popup-content {
                                    background-color: white;
                                    padding: 20px;
                                    border-radius: 5px;
                                    text-align: center;
                                }
                            
                                button {
                                    margin-top: 10px;
                                }
                            </style>
                            
                            <script>
                                document.addEventListener('DOMContentLoaded', function() {
                                    const cleanButton = document.getElementById('clean_button');
                                    const doneButton = document.getElementById('done_button');
                                    const popup = document.getElementById('loading-popup');
                                    const loadingSpinner = document.querySelector('.loading-spinner');
                                    let processing = false;
                            
                                    cleanButton.addEventListener('click', function() {
                                        const form = document.getElementById('catalog-cleaning-form');  
                                        const formData = new FormData(form);
                            
                                        // Show the loading popup
                                        popup.style.display = 'flex';
                                        loadingSpinner.style.display = 'block';
                                        doneButton.style.display = 'none';
                                        processing = true;
                            
                                        fetch('/catalog_cleaning_tool/', {
                                            method: 'POST',
                                            body: formData,
                                            headers: {
                                                'X-CSRFToken': '{{ csrf_token }}'
                                            }
                                        })
                                        .then(response => response.json())
                                        .then(data => {
                                            if (data.status !== 'success') {
                                                alert('Error: ' + data.message);
                                            }                             
                                            // Show the "Done" button and hide the loading spinner
                                            loadingSpinner.style.display = 'none';
                                            doneButton.style.display = 'block';
                                        })
                                        .catch(error => {
                                            console.error('Error:', error);
                                            alert('An error occurred.');
                                            loadingSpinner.style.display = 'none';
                                            doneButton.style.display = 'block';
                                        });
                                    });
                            
                                    doneButton.addEventListener('click', function() {
                                        popup.style.display = 'none';  // Close the popup
                                    });
                                });
                            </script>
                            
                            

                            <script>
                                document.addEventListener('DOMContentLoaded', function() {
                                    const aboutTitle = document.getElementById('about-title');
                                    const aboutDescription = document.getElementById('about-description');
                                    const inputField = document.getElementById('input-file-path');
                                    const outputField = document.getElementById('output-file-path');
                                    const defaultTitle = 'About';
                                    const defaultDescription = 'Lorem ipsum dolor sit amet consectetur. Vestibulum urna pulvinar aliquam volutpat. Sed libero egestas felis faucibus id nunc. Integer dui amet sagittis sed et consequat. Non tempus tempor aliquet lacus potenti aliquam.';

                                    // Function to reset to default about content
                                    function resetAboutCard() {
                                        aboutTitle.textContent = defaultTitle;
                                        aboutDescription.innerHTML = `<p>${defaultDescription}</p>`;
                                    }

                                    // Input field focus event
                                    inputField.addEventListener('focus', function() {
                                        aboutTitle.textContent = 'Input Folder or File(s)';
                                        aboutDescription.innerHTML = `
                                            <p>The input will accept a folder, multiple files, or a single file. Each file may contain any number of columns, but it is necessary to pre-process them and retain the following important columns:</p>
                                            <ul>
                                                <li>AUTHOR</li>
                                                <li>DATE</li>
                                                <li>TIME</li>
                                                <li>LAT</li>
                                                <li>LON</li>
                                                <li>DEPTH</li>
                                                <li>MAG</li>
                                                <li>TYPE</li>
                                            </ul>
                                        `;
                                    });

                                    // Output field focus event
                                    outputField.addEventListener('focus', function() {
                                        aboutTitle.textContent = 'Output Folder Information';
                                        aboutDescription.innerHTML = '<p>The output folder will contain the processed data after cleaning the earthquake catalog.</p>';
                                    });

                                    // Reset when clicking outside
                                    document.addEventListener('click', function(e) {
                                        if (!e.target.closest('.ECC-input-group') && !e.target.closest('.ECC-output-group')) {
                                            resetAboutCard();
                                        }
                                    });
                                });
                            </script>

                        </div>
                    </div>
                </div>
                
            </div>
        </section>

        <section class="background">
        </section>

        <section class="Info_Section1">
                <div class="Section1" id="About-section">
                    <img src="{% static 'images/NO IMAGE DARK.svg' %}" alt="Img 1" class="img2">
                    <div class="text">
                        <!-- <h4>Section title</h4> -->
                        <h5>Title</h5>
                        <p>Nunc, mattis arcu eu ut quisque quam. Nunc rhoncus, arcu venenatis consectetur facilisis. Nibh nibh porttitor lectus sit porta vestibulum. Gravida ultricies ultrices velit adipiscing nec ultricies curabitur adipiscing non. Porttitor feugiat at duis aliquam, viverra et amet. Duis pellentesque integer sem sit. Nisl praesent aliquam tellus metus sem id. Feugiat maecenas sollicitudin sed fusce turpis vel hendrerit. Commodo massa ac justo faucibus faucibus ipsum amet. Arcu tincidunt mattis lectus pellentesque in.</p>
                        <p>Nunc, mattis arcu eu ut quisque quam. Nunc rhoncus, arcu venenatis consectetur facilisis. Nibh nibh porttitor lectus sit porta vestibulum. Gravida ultricies ultrices velit adipiscing nec ultricies curabitur adipiscing non. Porttitor feugiat at duis aliquam, viverra et amet. Duis pellentesque integer sem sit. Nisl praesent aliquam tellus metus sem id. Feugiat maecenas sollicitudin sed fusce turpis vel hendrerit. Commodo massa ac justo faucibus faucibus ipsum amet. Arcu tincidunt mattis lectus pellentesque in.</p>
                    </div>
            </div>
        </section>

    </main>

    <footer>
        <nav>
            <a href="#">Our Vision</a>
            <a href="#">Features</a>
            <a href="#">Our Team</a>
            <a href="#">Latest News</a>
            <a href="#">Contact</a>
        </nav>
        <p>Copyright © SHADE PH 2024</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

</body>
</html>

