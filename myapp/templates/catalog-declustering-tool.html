{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHADE Project PH</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/stylesheet-CDT.css' %}">
</head>

<body>
    <header>
        <div class="header-container">
            <div class="logo-container">
                <img src="{% static 'images/SHADE LOGO.png' %}" alt="PHIVOLCS Logo" class="logo">
                <div class="text-container">
                    <h2>Philippine Institute of Volcanology and Seismology</h2>
                    <h1>SHADE PH</h1>
                </div>
            </div>
            <nav>
                <a href="{% url 'shade_redesign' %}" class="nav-link">Home</a>
                <a href="#About-section" class="nav-link">About</a>
                <span class="separator">|</span>
                <b href="#" class="nav-link">Register</b>
                <a href="#" class="nav-button">Log In</a>
            </nav>
        </div>
    </header>
    
    <main>
        <section class="Home" id="Home">
            <div class="container1">
                <div class="Title">
                    <h1>SHADE Project PH</h1>
                    <p>Seismic Hazard Assessment for Design Earthquake of the Philippines</p>
                </div>
                
                <div class="container2">
                    <div class="about-card" id="about-card">
                        <img src="{% static 'images/NO IMAGE DARK.svg' %}" alt="Img 1" class="img1">
                        <h2 id="about-title">About</h2>
                        <p id="about-description">
                            Lorem ipsum dolor sit amet consectetur. Vestibulum urna pulvinar aliquam volutpat. Sed libero egestas felis faucibus id nunc. Integer dui amet sagittis sed et consequat. Non tempus tempor aliquet lacus potenti aliquam.
                        </p>
                    </div>

                    <div class="form">
                        <div class="form-card">
                            <div class="form-header">
                                <img src="{% static 'images/CDT Header.svg' %}" class="card-icon">
                                <h2>Catalog Declustering Tool</h2>
                            </div>                                   
                            
                            <div class="form-content">
                                <form id="catalog-declustering-form">
                                    <div class="CDT-input-group">
                                        <label for="input-file-path">Input File</label>
                                        <input type="text" id="input-file-path" name="input_file_path" placeholder="C:/Users/SHADE/Aegean_ExtendedCat1.csv">
                                    </div>

                                    <div class="declustering-method-group">
                                        <label for="declustering-method">Declustering Method</label>
                                        <div class="dm-select" tabindex="0">
                                            <span class="select">Please Select</span>
                                            <img src="{% static 'images/expand_more.svg' %}" class="arrow-down">
                                        </div>
                                        <div class="dm-option-list">
                                            <div class="option" data-value="Gardner-Knopoff">Gardner-Knopoff</div>
                                            <div class="option" data-value="Afteran">Afteran</div>
                                        </div>
                                        <input type="hidden" id="declustering-method" name="declustering_method">
                                    </div>
                                    
                                    <div class="time-method-group">
                                        <label for="time-method">Time-Space Window</label>
                                        <div class="tm-select" tabindex="0">
                                            <span class="select">Please Select</span>
                                            <img src="{% static 'images/expand_more.svg' %}" class="arrow-down">
                                        </div>
                                        <div class="tm-option-list">
                                            <div class="option" data-value="Gardner-Knopoff">Gardner-Knopoff</div>
                                            <div class="option" data-value="Urhammer">Urhammer</div>
                                            <div class="option" data-value="Gruenthal">Gruenthal</div>
                                        </div>
                                        <input type="hidden" id="time-method" name="time_method">
                                    </div>

                                    <div class="CDT-output-group">
                                        <label for="output-file-path">Output Folder</label>
                                        <input type="text" id="output-file-path" name="output_file_path" placeholder="C:/Users/SHADE/Declustered/">
                                    </div>
                                </form>
                            </div>

                            <div class="button-group">
                                <button type="button" id="decluster-button">Decluster Catalog</button>
                            </div>

                            <div id="loading-popup" style="display: none;">
                                <div class="popup-content">
                                    <p>Processing data, please wait...</p>
                                    <div class="loading-spinner"></div>
                                    <button id="done_button" style="display: none;">Done</button>
                                </div>
                            </div>
                            
                            <style>
                                .loading-spinner {
                                    border: 16px solid #f3f3f3;
                                    border-radius: 50%;
                                    border-top: 16px solid blue;
                                    width: 80px;
                                    height: 80px;
                                    animation: spin 2s linear infinite;
                                }
                            
                                @keyframes spin {
                                    0% { transform: rotate(0deg); }
                                    100% { transform: rotate(360deg); }
                                }
                            
                                #loading-popup {
                                    position: fixed;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                    background-color: rgba(0, 0, 0, 0.5);
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                }
                            
                                .popup-content {
                                    background-color: white;
                                    padding: 20px;
                                    border-radius: 5px;
                                    text-align: center;
                                }
                            
                                button {
                                    margin-top: 10px;
                                }
                            </style>
                            
                            <script>
                                document.addEventListener('DOMContentLoaded', function() {
                                    // Handle Declustering Method Dropdown
                                    document.querySelectorAll('.dm-option-list .option').forEach(function(option) {
                                        option.addEventListener('click', function() {
                                            const selectedValue = option.getAttribute('data-value');
                                            document.querySelector('.dm-select .select').textContent = selectedValue;
                                            document.getElementById('declustering-method').value = selectedValue;
                                        });
                                    });
                            
                                    // Handle Time Method Dropdown
                                    document.querySelectorAll('.tm-option-list .option').forEach(function(option) {
                                        option.addEventListener('click', function() {
                                            const selectedValue = option.getAttribute('data-value');
                                            document.querySelector('.tm-select .select').textContent = selectedValue;
                                            document.getElementById('time-method').value = selectedValue;
                                        });
                                    });
                            
                                    const declusterButton = document.getElementById('decluster-button');
                                    const doneButton = document.getElementById('done_button');
                                    const popup = document.getElementById('loading-popup');
                                    const loadingSpinner = document.querySelector('.loading-spinner');
                            
                                    declusterButton.addEventListener('click', function() {
                                        const form = document.getElementById('catalog-declustering-form');
                                        const formData = new FormData(form);
                            
                                        // Show the loading popup
                                        popup.style.display = 'flex';
                                        loadingSpinner.style.display = 'block';
                                        doneButton.style.display = 'none';
                            
                                        fetch('/catalog_declustering_tool/', {
                                            method: 'POST',
                                            body: formData,
                                            headers: {
                                                'X-CSRFToken': '{{ csrf_token }}'
                                            }
                                        })
                                        .then(response => response.json())
                                        .then(data => {
                                            if (data.status === 'success') {
                                                alert('Calculation completed successfully!');
                                            } else {
                                                alert('Error: ' + data.message);
                                            }
                                            // Show the "Done" button and hide the loading spinner
                                            loadingSpinner.style.display = 'none';
                                            doneButton.style.display = 'block';
                                        })
                                        .catch(error => {
                                            console.error('Error:', error);
                                            alert('An error occurred.');
                                            loadingSpinner.style.display = 'none';
                                            doneButton.style.display = 'block';
                                        });
                                    });
                            
                                    doneButton.addEventListener('click', function() {
                                        popup.style.display = 'none';  // Close the popup
                                    });
                                });
                            </script>
                            

                            <script>
                                document.addEventListener('DOMContentLoaded', function() {
                                    const aboutTitle = document.getElementById('about-title');
                                    const aboutDescription = document.getElementById('about-description');
                                    const inputFileField = document.getElementById('input-file-path');
                                    const declusteringMethodField = document.querySelector('.declustering-method-group .dm-select');
                                    const timeMethodField = document.querySelector('.time-method-group .tm-select');
                                    const outputFolderField = document.getElementById('output-file-path');
                                    const defaultTitle = 'About';
                                    const defaultDescription = 'Lorem ipsum dolor sit amet consectetur. Vestibulum urna pulvinar aliquam volutpat. Sed libero egestas felis faucibus id nunc. Integer dui amet sagittis sed et consequat. Non tempus tempor aliquet lacus potenti aliquam.';

                                    // Function to reset to default about content
                                    function resetAboutCard() {
                                        aboutTitle.textContent = defaultTitle;
                                        aboutDescription.textContent = defaultDescription;
                                    }

                                    // Input file focus event
                                    inputFileField.addEventListener('focus', function() {
                                        aboutTitle.textContent = 'Input File Information';
                                        aboutDescription.textContent = 'The EQ Events that will be declustered must be transferred to the Aegean_ExtendedCat1.csv file provided.';
                                    });

                                    // Declustering method focus event
                                    declusteringMethodField.addEventListener('focus', function() {
                                        aboutTitle.textContent = 'Declustering Method Information';
                                        aboutDescription.textContent = 'Select a method for declustering the earthquake catalog. Options include Gardner-Knopoff or Afteran.';
                                    });

                                    // Time-space window method focus event
                                    timeMethodField.addEventListener('focus', function() {
                                        aboutTitle.textContent = 'Time-Space Window Information';
                                        aboutDescription.textContent = 'Select the time-space window method, such as Gardner-Knopoff, Urhammer, or Gruenthal, to determine the declustering parameters.';
                                    });

                                    // Output folder focus event
                                    outputFolderField.addEventListener('focus', function() {
                                        aboutTitle.textContent = 'Output Folder Information';
                                        aboutDescription.textContent = 'The output folder will store the results of the declustering process.';
                                    });

                                    // Reset when clicking outside
                                    document.addEventListener('click', function(e) {
                                        if (!e.target.closest('.CDT-input-group') && 
                                            !e.target.closest('.declustering-method-group') && 
                                            !e.target.closest('.time-method-group') && 
                                            !e.target.closest('.CDT-output-group')) {
                                            resetAboutCard();
                                        }
                                    });
                                });
                            </script>


                        </div>
                    </div>
                </div>
                
            </div>
        </section>

        <section class="background">
        </section>

        <section class="Info_Section1">
                <div class="Section1" id="About-section">
                    <img src="{% static 'images/NO IMAGE DARK.svg' %}" alt="Img 1" class="img2">
                    <div class="text">
                        <!-- <h4>Section title</h4> -->
                        <h5>Title</h5>
                        <p>Nunc, mattis arcu eu ut quisque quam. Nunc rhoncus, arcu venenatis consectetur facilisis. Nibh nibh porttitor lectus sit porta vestibulum. Gravida ultricies ultrices velit adipiscing nec ultricies curabitur adipiscing non. Porttitor feugiat at duis aliquam, viverra et amet. Duis pellentesque integer sem sit. Nisl praesent aliquam tellus metus sem id. Feugiat maecenas sollicitudin sed fusce turpis vel hendrerit. Commodo massa ac justo faucibus faucibus ipsum amet. Arcu tincidunt mattis lectus pellentesque in.</p>
                        <p>Nunc, mattis arcu eu ut quisque quam. Nunc rhoncus, arcu venenatis consectetur facilisis. Nibh nibh porttitor lectus sit porta vestibulum. Gravida ultricies ultrices velit adipiscing nec ultricies curabitur adipiscing non. Porttitor feugiat at duis aliquam, viverra et amet. Duis pellentesque integer sem sit. Nisl praesent aliquam tellus metus sem id. Feugiat maecenas sollicitudin sed fusce turpis vel hendrerit. Commodo massa ac justo faucibus faucibus ipsum amet. Arcu tincidunt mattis lectus pellentesque in.</p>
                    </div>
            </div>
        </section>

    </main>

    <footer>
        <nav>
            <a href="#">Our Vision</a>
            <a href="#">Features</a>
            <a href="#">Our Team</a>
            <a href="#">Latest News</a>
            <a href="#">Contact</a>
        </nav>
        <p>Copyright © SHADE PH 2024</p>
    </footer>


    <script>
document.addEventListener('DOMContentLoaded', function() {
    let dmOptions = document.querySelectorAll('.declustering-method-group .option');
    let dmSelectEle = document.querySelector('.declustering-method-group .select');
    let dmOptionList = document.querySelector('.dm-option-list');
    let dmDropdown = document.querySelector('.dm-select');

    let tmOptions = document.querySelectorAll('.time-method-group .option');
    let tmSelectEle = document.querySelector('.time-method-group .select');
    let tmOptionList = document.querySelector('.tm-option-list');
    let tmDropdown = document.querySelector('.tm-select');

    function toggleDropdown(optionList) {
        optionList.classList.toggle('active');
    }

    function selectOption(selectEle, optionList, option) {
        selectEle.innerText = option.innerText;
        optionList.classList.toggle('active');
    }

    dmDropdown.addEventListener('click', function() {
        toggleDropdown(dmOptionList);
    });

    tmDropdown.addEventListener('click', function() {
        toggleDropdown(tmOptionList);
    });

    dmOptions.forEach(function(option) {
        option.addEventListener('click', function() {
            selectOption(dmSelectEle, dmOptionList, this);
        });
    });

    tmOptions.forEach(function(option) {
        option.addEventListener('click', function() {
            selectOption(tmSelectEle, tmOptionList, this);
        });
    });
});

    </script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

</body>
</html>

